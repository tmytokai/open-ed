<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0">
<link rel="stylesheet" href="../../../seminar.css">
<style>
body.seminar{
background: #828282;
}
</style>
<title>5. 右折する</title>
</head>
<body class="seminar">

<div class="container">

<div class="btback"><a href="../#text04">メニューへ戻る</a></div>
<div class="btback"><a href="./page04.html">前のページ</a></div>
<div class="btback"><a href="./page06.html">次のページ</a></div>

<div class="contents">

<h1>5. 右折する</h1>

<div class="heading">
  <div class="number">1</div>
  <span>右折用のルートを作る</span>
</div>

<p>
これまで作ったプロクラムで前進と左折はうまく動くようになりましたが、右折しようとすると対向車にぶつかります。
そこで右折用のプログラムをここで作ります。
</p>

<p>
ただ、今の走行ルートは左まわりになっていますので、次のように「走行ルートを決める」ブロックの中身を置き換えて右まわりのルートになるようにして下さい。
</p>
<img src="./img/page05-fig1.png" alt="">


<p>
置き換えたら試しに「緑の旗」ボタンを押して実行して下さい。
だいたいは対向車が気を利かせて止まってくれますが(多分かなり怒っています)、それでも時々対向車にぶつかると思います。
</p>

<p><br></p>
<div class="heading">
  <div class="number">2</div>
  <span>「もし〜なら」ブロックの条件を考える</span>
</div>

<p>
では「もし〜なら」ブロックの条件を考えてみましょう。
</p>

<p>
まず"右折"かどうかを調べるために「ナビの方向」「ナビの距離」を使います。
そのうえで対向車までの距離を検知する「前方-右センサー」センサーを使います。
</p>

<p>
<b>目的：右折するときに対向車にぶつからない</b>
<br>
<b>必要な情報：「ナビの方向」「ナビの距離」「前方-右センサー」</b>
<br>
<b>必要で無い情報：その他の情報</b>
</p>

<p>
よって条件の表は次のようになります。
なお右折をあらわす条件は「ナビの方向」が2、かつ「ナビの距離」が30未満としました。
また右折のときは対向車が優先なので、センサーの数値は前のページよりも少し遠目にしました。
</p>

<div class="table">
<table>
<thead>
<tr> <th>「ナビの方向」</th><th>「ナビの距離」</th> <th>「前方-右センサー」</th> <th>「仮のスピード」</th> </tr>
</thead>
<tbody>
<tr><td class="center" rowspan="3">2(右折)</td><td class="center" rowspan="3">30未満</td> <td class="center"> 30 より大<br>(遠い) </td> <td class="center">50</td> </tr>
<tr> <td class="center"> 30以下、20より大<br>(近い) </td> <td class="center">20</td> </tr>
<tr> <td class="center"> 20以下<br>(目の前) </td> <td class="center">0</td> </tr>
</tbody>
</table>
</div>


<p>
これまでと同じ様に、この表を「もし〜ならば、でなければ」ブロックを使って置き換えると次のようになります。
</p>

<div class="table">
<table>
<tbody>
<tr><td class="center" colspan="5"> もし「ナビの方向」が2<br>かつ「ナビの距離」が30未満ならば </td> </tr>
<tr> <td rowspan="5">　</td> <td class="center" colspan="2">「前方-右センサー」</td> <td class="center">「仮のスピード」</td> </tr>
<tr> <td class="center" colspan="2" > 30 より大<br>(遠い) </td> <td class="center">50</td> </tr>
<tr> <td colspan="4">でなければ</td> </tr>
<tr> <td rowspan="2">　</td>  <td class="center"> 20より大<br>(近い) </td> <td class="center">20</td> </tr>
<tr> <td class="center"> でなければ<br>(目の前) </td> <td class="center">0</td> </tr>
</tbody>
</table>
</div>

<p><br></p>
<div class="challenge"><p>チャレンジ</p></div>
<p>
なぜこの表になるのか考えてみましょう。
</p>


<p><br></p>
<div class="heading">
  <div class="number">3</div>
  <span>表をもとにプログラミングする</span>
</div>

<p>
これで「もし〜なら」ブロックの条件が分かりましたので早速プログラミングしてみましょう。
</p>

<p>
まず「右折する」というオリジナルブロックを作ります。
このブロックは繰り返し使いますので「画面を再描画せずに実行する」をチェックしてください。
</p>
<img src="./img/page05-fig2.png" alt="">

<p>
「前の車にぶつからないようにする」ブロックの中身は次のようになります。
</p>


<p>
右折の条件の中身は上の表の内容とまったく同じになります。
</p>
<img src="./img/page05-fig3.png" alt="">

<p>
あとは「速度を決める」ブロックを次のように変更すればOKです。
</p>
<img src="./img/page05-fig4.png" alt="">


<p><br></p>
<div class="heading">
  <div class="number">4</div>
  <span>テストして数値を調整する</span>
</div>

<p>
では「緑の旗」ボタンを押してテストしてみましょう。
</p>

<p>
もし他の車にぶつかったり、赤信号にひっかかったりしてゲームオーバーになる場合はセンサーなどの数値を調整(ちょうせい)してください。
この調整作業は本物の自動運転車を作る場合でもとても大事な作業になりますので、世界中のいろんな所で本物の自動運転車を走らせてテストをしている訳ですね。
</p>

<p><br></p>
<div class="challenge"><p>チャレンジ</p></div>
<p>
「前方-左センサー」と「前方-右センサー」は車の前方しかみないので、渋滞などでカーブした先に車がいると衝突するときがあります。
カーブの先にいる車を見つけるためには「左センサー」と「右センサー」も使う必要があります。
「左センサー」と「右センサー」も使ってカーブの先にいる車にぶつからないようにしてみましょう。
</p>

</div>

<div class="btback"><a href="../#text04">メニューへ戻る</a></div>
<div class="btback"><a href="./page04.html">前のページ</a></div>
<div class="btback"><a href="./page06.html">次のページ</a></div>

</div>


</body>
</html>
