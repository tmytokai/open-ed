<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0">
<link rel="stylesheet" href="../../../common.css">
<script src="../../../common.js"></script>
<script src="../../../mathjax.js"></script>
<title>2. Z変換とラプラス変換の関係</title>
</head>
<body>

<nav class="brcr">
<ol>
<li><a href="../">アクティビティ: Z変換</a></li>
<li>学習項目: [1] Z変換</li>
<li><script>GetTitle()</script></li>
</ol>
</nav>

<h2><script>GetTitle()</script></h2>

<p>
このページでは Z 変換が時間領域ディジタル信号 $f[i]$ に対する<a href="../../laplace">ラプラス変換</a>であることを説明します。
</p>

<p>
サンプリング元のアナログ信号を $f(t)$ とし、$\tau$ [秒]をサンプリング間隔とすると、<a href="../../d-signal/text02/page01.html">サンプリング</a>のアクティビティで説明した様に、
<p>

\begin{align*}
f[i] = f( \tau \cdot i )
\end{align*}

<p>
で表されます(図1)。
</p>

<div class="info">
<input type="checkbox"><b>図1:  サンプリング例 </b>

<p>
　
</p>

<img src="./img/page02-fig1.png" alt="">
</div>

<p>
まず $f[i]$ をアナログ信号とみなして直接ラプラス変換することを考えます。
<br>
つまり
</p>

\begin{align*}
f'(t) =
\begin{cases}
f[i] &, (t = \tau \cdot i) \\
\\
0 &, (\text{それ以外の時刻})
\end{cases}
\end{align*}

<p>
というアナログ信号 $f'(t)$ のラプラス変換が $f[i]$ のラプラス変換であるとします。
</p>

<p>
ところが実際に(両側)ラプラス変換を計算すると、積分の幅が0であるため
</p>

\begin{align*}
\textrm{F}(s) 
&= \int_{-\infty}^\infty f'(t) \cdot \textrm{e}^{-st} dt \\
&= \sum_{i=-\infty}^{\infty} \int_{\tau \cdot i}^{\tau \cdot i} f[i] \cdot \textrm{e}^{-st} dt \\
&= \sum_{i=-\infty}^{\infty} \left \{ f[i] \cdot \int_{\tau \cdot i}^{\tau \cdot i} \textrm{e}^{-st} dt \right \} \\
& = \sum_{i=-\infty}^{\infty} 0 \\
& = 0
\end{align*}

<p>
という様に結果が 0 になってしまって上手く行きません。
</p>
 
<p>
積分の幅が 0 であったことが失敗の原因ですので、次は図 2 の様な窓関数 $g(t)$ を使い、図3の様に $f(t)$ をサンプリング間隔 τ 秒おきに幅 $2\epsilon$ で切り出して作成した信号に対してラプラス変換する事を考えます。
</p>

<div class="info">
<input type="checkbox"><b>図2:  窓関数 </b>

<p>
$\epsilon$ を微小な正の定数とする
</p>

<img src="./img/page02-fig2.png" alt="">
</div>

<p>
　
</p>

<div class="info">
<input type="checkbox"><b>図3:  窓関数 $g(t)$ で元のアナログ信号 $f(t)$ を切り出す </b>

<p>
窓関数 $g(t)$ を平行移動した $g(t-\tau\cdot i)$ を $f(t)$ にかける
</p>

<img src="./img/page02-fig3.png" alt="">
</div>

<p>
ただし $\epsilon$ が小さいとやはり積分結果がほぼ 0 になってしまうので、積分した結果が0にならないように充分大きい任意の正定数 $\alpha > 0$ をあらかじめ $f(t)$ に掛けてゲイン調整をしておきます。
</p>

<p>
以上をまとめると
</p>

\begin{align*}
f'(t) =
\begin{cases}
\alpha \cdot f(t) &, ( \tau \cdot i - \epsilon \leq t \leq \tau \cdot i + \epsilon\ ,\ i\ \text{は全ての整数} ) \\
\\
0 &, (\text{それ以外の時刻})
\end{cases}
\end{align*}

<p>
というアナログ信号 $f'(t)$ に対して(両側)ラプラス変換を行います。
</p>

<p>
すると今回は
</p>

\begin{align*}
\textrm{F}(s)
&= \int_{-\infty}^\infty f'(t) \cdot \textrm{e}^{-st} dt \\
&= \sum_{i=-\infty}^{\infty} \left \{ \alpha \cdot \int_{\tau \cdot i - \epsilon}^{\tau \cdot i + \epsilon} f(t) \cdot \textrm{e}^{-st} dt \right \} \\
\end{align*}

<p>
が得られます。
<br>
ここで(本当はいろいろ条件が必要なのですが面倒なので全部条件を満たしていると考えることにすると)<a href="https://ja.wikipedia.org/wiki/%E5%B9%B3%E5%9D%87%E5%80%A4%E3%81%AE%E5%AE%9A%E7%90%86">積分の平均値の定理</a>より
<br>
 
\begin{align*}
\int_{\tau \cdot i - \epsilon}^{\tau \cdot i + \epsilon} f(t) \cdot \textrm{e}^{-st} dt
= 2\epsilon \cdot f(\xi_i) \cdot \textrm{e}^{-s \xi_i}
\end{align*}

<p>
を満たす $\xi_i$ が
</p>

\begin{align*}
\tau \cdot i - \epsilon \leq \xi_i \leq \tau \cdot i + \epsilon
\end{align*}

<p>
の範囲に必ず存在します。
<br>
よってこの式を上の $\textrm{F}(s)$ に代入します。
</p>

\begin{align*}
\textrm{F}(s)
= \sum_{i=-\infty}^{\infty} \left \{ 
\alpha \cdot
2\epsilon \cdot f(\xi_i) \cdot \textrm{e}^{-s \xi_i}
\right \} \\
\end{align*}

<p>
さらにゲイン調整用のパラメータ $\alpha$ は任意の正整数だったので $\alpha = 1/2\epsilon$ を代入します。
</p>

\begin{align*}
\textrm{F}(s)
= \sum_{i=-\infty}^{\infty} \left \{ 
f(\xi) \cdot \textrm{e}^{-s \xi_i}
\right \} \\
\end{align*}


<p>
あとは $\epsilon \rightarrow 0 $ とすることで $\xi_i \rightarrow \tau \cdot i $ となりますので、
</p>

\begin{align*}
\textrm{F}(s) 
&= \sum_{i=-\infty}^{\infty} \left \{ 
f( \tau \cdot i ) \cdot \textrm{e}^{-s \cdot \tau \cdot i}
\right \} \\
&= \sum_{i=-\infty}^{\infty} \left \{ f[i] \cdot \textrm{e}^{-s \cdot \tau \cdot i} \right \}
\end{align*}

<p>
が得られます。
<br>
この式をディジタル信号 $f[i]$ の(両側)ラプラス変換と定義します。
</p>

<div class="info">
<input type="checkbox"><b>ディジタル信号 $f[i]$ の(両側)ラプラス変換 </b>

<p>
$\tau$ [秒]をサンプリング間隔、$s = \sigma + j \cdot w$ を S 平面上の任意の点としたとき、
</p>

\begin{align*}
\textrm{F}(s) = \sum_{i=-\infty}^\infty \{ f[i] \cdot \textrm{e}^{- s \cdot \tau \cdot i} \}
\end{align*}

</div>

<p>
さて上の式に $s = \sigma + j \cdot w$ を代入してみます。
</p>

\begin{align*}
\textrm{F}(\sigma + j \cdot w) 
&= \sum_{i=-\infty}^\infty \{ f[i] \cdot \textrm{e}^{- ( \sigma + j \cdot w) \cdot \tau \cdot i} \} \\
&= \sum_{i=-\infty}^\infty \{ f[i] \cdot \textrm{e}^{- \sigma \cdot \tau \cdot i} \cdot \textrm{e}^{- j \cdot w \cdot \tau \cdot i} \}
\end{align*}


<p>
さらに$w_s$ をサンプリング角周波数としたとき、 $\tau = 2\pi/w_s$ を最後の項に代入すると
</p>

\begin{align*}
\textrm{F}(\sigma + j \cdot w)
&= \sum_{i=-\infty}^\infty 
\left \{ 
f[i] \cdot \textrm{e}^{- \sigma \cdot \tau \cdot i} \cdot \textrm{e}^{- j \cdot 2 \pi \cdot \frac{w}{w_s} \cdot i} 
\right \}
\end{align*}


<p>
という式が出てきます。
<br>
ここで $k$ を任意の整数とすると
</p>

\begin{align*}
\textrm{F}(\sigma + j \cdot (w + k \cdot w_s )
&= \sum_{i=-\infty}^\infty 
\left \{ 
f[i] \cdot \textrm{e}^{- \sigma \cdot \tau \cdot i} \cdot \textrm{e}^{- j \cdot 2 \pi \cdot \frac{w + k \cdot w_s}{w_s} \cdot i} 
\right \} \\
&= \sum_{i=-\infty}^\infty 
\left \{ 
f[i] \cdot \textrm{e}^{- \sigma \cdot \tau \cdot i} \cdot \textrm{e}^{- j \cdot 2 \pi \cdot \frac{w}{w_s} \cdot i} \cdot \textrm{e}^{- j \cdot 2 \pi \cdot k \cdot i} 
\right \} \\
&= \sum_{i=-\infty}^\infty 
\left \{ 
f[i] \cdot \textrm{e}^{- \sigma \cdot \tau \cdot i} \cdot \textrm{e}^{- j \cdot 2 \pi \cdot \frac{w}{w_s} \cdot i} 
\right \} \\
& = \textrm{F}(\sigma + j \cdot w)
\end{align*}

<p>
が成り立ちます。
<br>
つまり
</p>

<p>
「<b>ディジタル信号 $f[i]$ のラプラス変換 $\textrm{F}(s)$ は S 平面上で角周波数 $w$ に関し周期 $w_s$ で周期的</b>」
</p>

<p>
になりますので、$-w_s/2 \leq w \leq w_s/2$ 、つまり ± ナイキスト角周波数の範囲に $w$ の帯域を制限して考えることが出来ます(図4)。
</p>

<div class="info">
<input type="checkbox"><b>図4: $\textrm{F}(s)$ は S 平面上で $w$ に関し周期 $w_s$ で周期的 </b>

<p>
　
</p>

<img src="./img/page02-fig4.png" alt="">
</div>


<p>
次に
</p>

\begin{align*}
z &= \textrm{e}^{ s \cdot \tau } \\
&= \textrm{e}^{ \sigma \cdot \tau } \cdot \textrm{e}^{ j \cdot w \cdot \tau }
\end{align*}

<p>
という座標変換を考えます。
<br>
この座標変換によって作られる複素平面のことを「<b>Z 平面</b>」と呼びます。
</p>

<p>
ここで $z$ は絶対値が $|z| = \textrm{e}^{ \sigma \cdot \tau }$、偏角が $\angle z = w \cdot \tau$ の<a href="../../complex/text01/page03.html">極形式</a>になっています。
<br>
また $\tau = 2\pi/w_s$ より偏角の範囲は $-\pi \leq \angle z \leq \pi$ となりますので、S平面上の点 $s$ と Z 平面上の点 $z$ は 1 対 1 で対応しています(図5)。
</p>

<div class="info">
<input type="checkbox"><b>図5: S平面とZ平面の関係 </b>

<p>
座標変換 $z = \textrm{e}^{ s \cdot \tau }$ によって S 平面と Z 平面上の点は 1 対 1 で対応づけられる
</p>

<img src="./img/page02-fig5.png" alt="">
</div>

<p>
あとは $f[i]$ のラプラス変換 $\textrm{F}(s)$ に $z = \textrm{e}^{ s \cdot \tau }$ を代入すれば、Z平面上の複素関数
</p>

\begin{align*}
\textrm{F}(z) = \sum_{i=-\infty}^\infty \{ f[i] \cdot z^{-i} \}
\end{align*}

<p>
つまり Z 変換が得られます。
<br>
逆に言えば、$\textrm{F}(z)$ に $z = \textrm{e}^{ s \cdot \tau }$ を代入するとラプラス変換 $\textrm{F}(s)$ になります。
</p>

<br>
<h3>(参考) くし型関数による Z 変換の導出</h3>

<br>
<p>
デルタ関数の性質より
</p>

\begin{align*}
\int_{-\infty}^\infty f(t) \cdot \delta(t - \tau \cdot i) \cdot \textrm{e}^{-st} dt 
&= f( \tau \cdot i ) \cdot \textrm{e}^{-s \cdot \tau \cdot i} \\
&= f[i] \cdot \textrm{e}^{-s \cdot \tau \cdot i}
\end{align*}

<p>
ですので
</p>

\begin{align*}
\textrm{F}(s) 
&= \sum_{i=-\infty}^{\infty} \left \{ f[i] \cdot \textrm{e}^{-s \cdot \tau \cdot i} \right \} \\
&= \sum_{i=-\infty}^{\infty} \left \{ 
\int_{-\infty}^\infty f(t) \cdot \delta(t - \tau \cdot i) \cdot \textrm{e}^{-st} dt 
\right \} \\
&= \int_{-\infty}^\infty 
\left [
\sum_{i=-\infty}^{\infty} \left \{ f(t) \cdot \delta(t - \tau \cdot i) \right \} 
\right ]
\cdot \textrm{e}^{-st} dt 

\end{align*}

<p>
という式が出てきます。
<br>
つまり直感的には
</p>

<p>
「<b>Z 変換はアナログ信号 $f(t)$ に対しサンプリング間隔 $\tau$ 秒おきにインパルス信号(デルタ関数)をかけた信号のラプラス変換</b>」
</p>

<p>
と言えます。
</p>

<p>
ちなみにサンプリング間隔 $\tau$ 秒おきにインパルス信号を並べた信号のことを「<b><a href="https://ja.wikipedia.org/wiki/%E3%81%8F%E3%81%97%E5%9E%8B%E9%96%A2%E6%95%B0">くし型関数</a></b>」と呼び、信号処理分野では理想的なサンプラーモデルとして何か計算する時に良く使われています。
</p>

<br>
<script>PreNext(2,6)</script>
</body>
</html>
