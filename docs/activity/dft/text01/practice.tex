\documentclass[a4paper]{jarticle}

\def\texdir{../../../tex}
\input{\texdir/common}

\begin{document}

\prachead{離散フーリエ変換 (DFT)}{[1] DFT と IDFT}

%%%%%%%%%%%%%%%%%%%%%%%%
\pracpage{周期性時間領域ディジタル信号}


\pracpc{15} 表計算ソフトを使って周期性時間領域ディジタル信号のグラフを描いてみましょう。\par
\vspace{1zh}
\begin{enumerate}
\item 周期性時間領域ディジタル信号の式は

\[
f[i] = 
-1
+ 2 \cdot \cos \left ( \frac{2 \pi}{ \left ( \frac{15}{1} \right ) } \cdot i + 1 \right )
+ 4 \cdot \cos \left ( \frac{2 \pi}{ \left ( \frac{15}{3} \right ) } \cdot i +0.5 \right )
+ 3 \cdot \cos \left ( \frac{2 \pi}{ \left ( \frac{15}{7} \right ) } \cdot i -2 \right )
\]

とします。
\item 時刻の範囲は $i = 0, 1,  \cdots, 45$ とします。
\item グラフは点あり、線あり、平滑化「無し」とします。
\item グラフを描いたら周期 $\textrm{N}$ [点]を求めてタイトルに追加記述して下さい。
\item グラフを画像ファイルに変換してアップロードして下さい。
\end{enumerate}

%%%%%%%%%%%%%%%%%%%%%%%%
\pracpage{DFT と IDFTの定義}

\vspace{2zh}
\noindent 演習無し

%%%%%%%%%%%%%%%%%%%%%%%%
\pracpage{プログラミング}

\pracpc{15} 周期性時間領域ディジタル信号の信号値をプログラム上で求め、表計算ソフトを使ってグラフ化してみましょう。\par
\par\vspace{1zh}
\begin{enumerate}
\item 自分の好きなプログラミング言語を使って結構ですが、C 言語の使用を前提として説明します。
\item 時間領域ディジタル信号の式は演習 1 と同様とします。
\item const int 型変数 N を定義して演習 1 で求めた周期を代入して下さい。
\item double 型配列 f[N] を定義して下さい。
\item 時間領域ディジタル信号の値を for ループを使って計算して代入して下さい。\par
　※ 15/7 の所は 15.0/7.0 として下さい(そうしないと整数で演算されて 15/7 = 2 となります)。
\item 求めた f[0] 〜 f[N-1] の値を何らかの方法で表計算ソフトに取り込んでください。
\item グラフを描いて下さい。時刻の範囲は $i = 0, 1,  \cdots, 45$ とします。\par
　※ 周期的な信号なので足りない分は f[0] 〜 f[N-1] の値をコピペして下さい。
\item グラフは点あり、線あり、平滑化「無し」とします。
\item 完成したグラフの形と演習 1で作成したグラフの形が一致していることを確認して下さい。
\item ソースコードとグラフを同じドキュメントファイル(docx形式)に保存してアップロードして下さい。
\end{enumerate}

\pracpc{90} 周期性時間領域ディジタル信号の DFT 係数 $\textrm{C}[k]$ をプログラムで計算し、DFT係数の絶対値と偏角を表計算ソフトを使ってグラフ化してみましょう  \par
\par\vspace{1zh}
\begin{enumerate}
\item 自分の好きなプログラミング言語を使って結構ですが、C 言語の使用を前提として説明します。
\item 時間領域ディジタル信号の式は演習 1 と同様とします。
\item 演習 2 のソースコードをコピーし、続きから作成します。\par
　※ 演習 2 で書いた部分のコードは書き換えないで return 0 の真上から書いて行って下さい。
\item double 型配列 A[N] を定義して下さい。
\item DFT 係数の実数成分 $\textrm{A}[0]$ 〜 $\textrm{A}[\textrm{N}-1]$ を k,i の 2 重 for ループを使って計算して 配列 A[] に代入して下さい。
\item double 型配列 B[N] を定義して下さい。
\item DFT 係数の虚数成分 $\textrm{B}[0]$ 〜 $\textrm{B}[\textrm{N}-1]$ を k,i の 2 重 for ループを使って計算して 配列 B[] に代入して下さい。
\item double 型配列 abs\_C[N] を定義して下さい。\par
 ※ abs は absolute value: 絶対値の略です。
\item DFT 係数の絶対値 $|\textrm{C}[0]|$ 〜 $|\textrm{C}[\textrm{N}-1]|$ を k の for ループを使って計算して配列 abs\_C[] に代入して下さい。
\item double 型配列 arg\_C[N] を定義して下さい。\par
 ※ arg は argument: 偏角の略です。
\item DFT 係数の偏角 $\angle\textrm{C}[0]$ 〜 $\angle\textrm{C}[\textrm{N}-1]$ を k の for ループを使って計算して配列 arg\_C[]  に代入して下さい。\par
 ※  絶対値の値が小さいと偏角の値が正しく出ないので、$|\textrm{C}[k]| < 0.01$ の時は $\angle\textrm{C}[k] = 0$ として下さい(この $0.01$ という値は適当に決めたもので特に深い意味はありません)。\par
\item 求めた abs\_C[0] 〜  abs\_C[N-1] と arg\_C[0] 〜 arg\_C[N-1] の値を何らかの方法で表計算ソフトに取り込み、それぞれ別々にグラフを描いて下さい。
\item グラフは点あり、線「無し」、平滑化「無し」とします。
\item ソースコードと2つのグラフを同じドキュメントファイル(docx形式)に保存してアップロードして下さい。
\end{enumerate}

\pracpc{30} DFT 係数 $\textrm{C}[k]$ から元の周期性時間領域ディジタル信号をプログラムで復元してみましょう。\par
\par\vspace{1zh}
\begin{enumerate}
\item 自分の好きなプログラミング言語を使って結構ですが、C 言語の使用を前提として説明します。
\item 演習 3 のソースコードをコピーし、続きから作成します。\par
　※ 演習 3 で書いた部分のコードは書き換えないで return 0 の真上から書いて行って下さい。
\item double 型配列 f2[N] を定義して下さい。
\item 配列 A[] と B[] から元の信号値を i,k の 2 重 for ループを使って復元して 配列 f2[] に代入して下さい。
\item 求めた f2[0] 〜 f2[N-1] の値を何らかの方法で表計算ソフトに取り込んでください。
\item グラフを描いて下さい。時刻の範囲は $i = 0, 1,  \cdots, 45$ とします。\par
　※ 周期的な信号なので足りない分は f2[0] 〜 f2[N-1] の値をコピペして下さい。
\item グラフは点あり、線あり、平滑化「無し」とします。
\item 完成したグラフの形と演習 1 及び演習 2 で作成したグラフの形が一致していることを確認して下さい。
\item ソースコードとグラフを同じドキュメントファイル(docx形式)に保存してアップロードして下さい。
\end{enumerate}

%%%%%%%%%%%%%%%%%%%%%%%%
\pracpage{DFT と IDFTの意味}

\pracpc{20} 任意の周期性時間領域ディジタル信号の高調波成分をプログラムで求めてみましょう。 \par
\par\vspace{1zh}
\begin{enumerate}
\item 自分の好きなプログラミング言語を使って結構ですが、C 言語の使用を前提として説明します。
\item 演習 4 のソースコードをコピーします。
\item 周期 N の値を 9 に変更します。
\item 演習 2 で作った部分(f[]にforループで値をセット)を削除し、代わりに double f[N] = \{8, 7, 6, 5, 4, 3, 2, 1, 0 \}; と配列 f[] を初期化します。
\item これ以降は 演習 4 の続きから作成します。\par
　※ 上の変更部と演習 4 で書いた部分のコードは書き換えないで return 0 の真上から書いて行って下さい。
\item double 型配列 T[N] を定義して下さい。\par
　※ 実際には T[1] 〜 T[(N-1)/2] しか使わないのですが多めにメモリを確保しています。
\item 第 $k$ 高調波の周期 $\textrm{T}_k$ を求めて T[1] 〜 T[(N-1)/2] に代入して下さい。
\item double 型配列 a[N] を定義して下さい。
\item 直流成分を abs\_C[0] と arg\_C[0] の値から求めて a[0] に代入して下さい。\par
　※ arg\_C[0] が 0 なら a[0] = $\textrm{C}[0]$ = abs\_C[0] * $\textrm{e}^{0\cdot j}$ = abs\_C[0]、\par
　 　arg\_C[0] が $\pm\pi$ なら a[0] = abs\_C[0] * $\textrm{e}^{\pm\pi \cdot j}$ = -abs\_C[0] です。
\item 第 $k$ 高調波( $k = 1$ の時は基本波)の振幅を abs\_C[1] 〜  abs\_C[(N-1)/2] の値から求めて a[1] 〜 a[(N-1)/2] に代入して下さい。
\item double 型配列 phi[N] を定義して下さい。
\item 第 $k$ 高調波( $k = 1$ の時は基本波)の位相を arg\_C[1] 〜 arg\_C[(N-1)/2] の値から求めて phi[1] 〜 phi[(N-1)/2] に代入して下さい。
\item T[1] 〜 T[(N-1)/2] の値を表示して下さい。
\item a[0] の値を表示して下さい。
\item a[1] 〜 a[(N-1)/2] の値を表示して下さい。
\item phi[1] 〜 phi[(N-1)/2] の値を表示して下さい。
\item ソースコードと表示結果を同じドキュメントファイル(docx形式)に保存してアップロードして下さい。
\end{enumerate}


\pracpc{30} 任意の周期性時間領域ディジタル信号をサイン波を合成して作ってみましょう。\par
\vspace{1zh}
\begin{enumerate}
\item 演習 5 で求めた T[1] 〜 T[(N-1)/2] の値を何らかの方法で表計算ソフトに取り込んで下さい。
\item 同様に a[0] の値を表計算ソフトに取り込んで下さい。
\item 同様に a[1] 〜 a[(N-1)/2] の値を表計算ソフトに取り込んで下さい。
\item 同様に phi[1] 〜 phi[(N-1)/2] の値を表計算ソフトに取り込んで下さい。
\item 直流成分のグラフを a[0] を使って描いて下さい。
\item 時刻の範囲は $i = 0, 1,  \cdots, 27$ とします。
\item グラフは点あり、線あり、平滑化「無し」とします。
\item 同様に基本波のグラフを T[1] 、 a[1] 、 phi[1] を使って描いて下さい。
\item 同様に第 2 〜 (N-1)/2 高調波のグラフを T[k] 、 a[k] 、 phi[k] を使って描いて下さい。
\item 各時刻 i 毎に直流成分、基本波、第 2 〜 (N-1)/2 高調波の値を足し合わせた信号のグラフを描いて下さい。
\item 描いたグラフが \{8, 7, 6, 5, 4, 3, 2, 1, 0 \} を繰り返した様な形となっていることを確認して下さい。\par
　※ 計算誤差があるので足しあわせた結果がきれいな整数値になるとは限りません。
\item 各グラフを同じドキュメントファイル(docx形式)に保存してアップロードして下さい。
\end{enumerate}

%%%%%%%%%%%%%%%%%%%%%%%%
\pracpage{高速フーリエ変換 (FFT)}

\vspace{2zh}
\noindent 演習無し


\savepractime

\end{document}
