<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0">
<link rel="stylesheet" href="../../../common.css">
<script src="../../../common.js"></script>
<script src="../../../mathjax.js"></script>
<title>1. 線形予測モデル</title>
</head>
<body>

<nav class="brcr">
<ol>
<li><a href="../">アクティビティ: ディジタル線形フィルタ</a></li>
<li>学習項目: [4] ARモデル</li>
<li><script>GetTitle()</script></li>
</ol>
</nav>

<h2><script>GetTitle()</script></h2>

<p>
AR モデルについて説明する前にARモデルの基盤となっている「<b>線形予測モデル</b>」について説明します。
</p>

<p>
まずディジタル信号を $x[0]$ から $x[\textrm{N}-1]$ まで $\textrm{N}$ 個分だけ手に入れたという状況を考えます。
<br>
この時、時刻 $i$ における信号値 $x[i]$ に何かしらの数学的な構造を仮定することを「<b>モデル化</b>」とか「<b>モデリング</b>」と言います。
</p>

<p>
ここで説明する線形予測モデルでは $x[i]$ の値は過去 $\textrm{L}$ 個の信号値と係数の<a href="../text01/page04.html">畳み込み</a>から求められるというモデルを仮定しますが、このモデルが本当に正しいモデルなのかは誰も分かりませんので、このモデルで求めた $x[i]$ の値はあくまで予測値となります。
</p>

<p>
それで、線形予測モデルは次のように定義されます。
</p>

<div class="info">
<input type="checkbox"><b>定義： $\textrm{L}$ 次線形予測モデル : </b>

<p>
$\textrm{L}$ を正の整数とした時
</p>

\begin{align*}
\hat{x}[i]
& = -\sum_{n=1}^{\textrm{L}} \{ a[n] \cdot x[i-n] \} \} \\
& = -a[1] \cdot x[i-1] -a[2] \cdot x[i-2] - \cdots -a[\textrm{L}] \cdot x[i-\textrm{L}]
\end{align*}

<p>
$\hat{x}[i]$ ・・・ $x[i]$ の予測値
</p>

<p>
$a[n]$ ・・・ <b>LPC 係数</b>(Linear Prediction Coefficient)、または<b>線形予測係数</b>と呼ぶ
</p>

</div>

<p>
$\sum$ の前にマイナスが付いている理由は<a href="./page02.html">次ページ</a>で説明しますので、今の所は特に気にしなくても結構です。
</p>

<p>
ところでこの線形予測モデルは $\textrm{L}$ 次の<a href="../text02/page01.html">FIR フィルタ</a>の形式になっています。
<br>
よって線形予測モデルは次のブロック図で表されます。
</p>


<div class="info">
<input type="checkbox"><b> $\textrm{L}$ 次線形予測モデルのブロック図: </b>

<p>
　
</p>

<img src="./img/page01-fig1.png" alt="">

</div>

<p>
信号 $x[i]$ をモデル化しましたので、次は $\textrm{L}$ 個の LPC 係数 $a[1]$ 〜 $a[\textrm{L}]$ を求めます。
<br>
LPC 係数は次に示す<b>正規方程式</b>または<b>Yule-Walker 方程式</b>を解くことによって求められます。

</p>

<div class="info">
<input type="checkbox"><b>定義： 正規方程式(Yule-Walker 方程式): </b>

<p>
次の $\textrm{L}$ 次連立方程式を正規方程式または Yule-Walker 方程式と呼ぶ
</p>

\[
\begin{array}{rrrrrc}
R[0]\cdot a[1] & +R[1]\cdot a[2] & +R[2]\cdot a[3] & +\cdots & +R[\textrm{L}-1]\cdot a[\textrm{L}] & =-R[1] \\
R[1]\cdot a[1] & +R[0]\cdot a[1] & +R[1]\cdot a[3] & +\cdots & +R[\textrm{L}-2]\cdot a[\textrm{L}] & =-R[2] \\
R[2]\cdot a[1] & +R[1]\cdot a[1] & +R[0]\cdot a[3] & +\cdots & +R[\textrm{L}-3]\cdot a[\textrm{L}] & =-R[3] \\
 &  & \vdots &  &  &  \\
R[\textrm{L}-1]\cdot a[1] & +R[\textrm{L}-2]\cdot a[2] & +R[\textrm{L}-3]\cdot a[3] & +\cdots & +R[0]\cdot a[\textrm{L}] & =-R[\textrm{L}] \\
\end{array}
\]

<p>
　
</p>

<p>
$R[n]$ ・・・ $x[i]$ の<a href="../../acr/">自己相関関数</a>
</p>

</div>

<p>
さて正規方程式はただの連立方程式なのでガウス消去法などのアルゴリズムを使って解くことが出来ます。
<br>
ただし正規方程式は<b>テプリッツ(Toeplitz)行列</b>という特殊な形をしているので、次に示す<b>レビンソン・ダービン(Levinson-Durbin)・アルゴリズム</b>を使って高速に計算することが可能です。
<br>
さらにレビンソン・ダービン・アルゴリズムは計算途中で<b>PARCOR(パーコール)係数</b>と呼ばれる重要なパラメータも同時に計算してくれるというメリットがあります(※)。
</p>

<p>
※ 今回のアクティビティではPARCOR係数は取り扱わないので、興味のある人は自学自習して下さい。
</p>

<div class="info">
<input type="checkbox"><b>レビンソン・ダービン(Levinson-Durbin)・アルゴリズム: </b>

<div class="olradio"> 
<p>
<span class="olradio"><input type="radio" name="LD"></span> 自己相関関数 R[0] 〜 R[L] を計算する
<br>
<span class="olradio"><input type="radio" name="LD"></span> 変数 e (予測誤差の自乗和)に R[0] を代入
<br>
<span class="olradio"><input type="radio" name="LD"></span> 変数 W に R[1] を代入
<br>
<span class="olradio"><input type="radio" name="LD"></span> n = 1 から L までの for ループに入る
<br>
<span class="olradio"><input type="radio" name="LD"></span> a[1] 〜 a[n]の値を a2[1] 〜 a2[n] にバックアップ
<br>
<span class="olradio"><input type="radio" name="LD"></span> 変数 P[n] (PARCOR 係数)に W/e を代入
<br>
<span class="olradio"><input type="radio" name="LD"></span> a[n] に -P[n] を代入
<br>
<span class="olradio"><input type="radio" name="LD"></span> i = 1 から n-1 までの for ループに入る
<br>
<span class="olradio"><input type="radio" name="LD"></span> a[i] = a2[i] - P[n] * a2[n-i] と更新
<br>
<span class="olradio"><input type="radio" name="LD"></span> i のループを抜ける
<br>
<span class="olradio"><input type="radio" name="LD"></span> e = e * ( 1 - P[n]*P[n] ) と更新
<br>
<span class="olradio"><input type="radio" name="LD"></span> W = R[n+1] + $\sum_{i=1}^{n}$ { a[i] * R[n+1-i] } と更新
<br>
<span class="olradio"><input type="radio" name="LD"></span> n のループを抜ける
</p>
</div>

</div>

<br>
<script>PreNext(1,3)</script>
</body>
</html>
