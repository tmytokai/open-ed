<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0">
<link rel="stylesheet" href="../../../common.css">
<script src="../../../common.js"></script>
<script src="../../../mathjax.js"></script>
<title>2. 移動平均フィルタ</title>
</head>
<body>

<nav class="brcr">
<ol>
<li><a href="../">アクティビティ: ディジタル線形フィルタ</a></li>
<li>学習項目: [2] FIRフィルタの設計</li>
<li><script>GetTitle()</script></li>
</ol>
</nav>

<h2><script>GetTitle()</script></h2>

<p>
最も基本的な FIR フィルタは(単純)移動平均フィルタ(Simple Moving Average Filter)です。
</p>

<p>
この移動平均フィルタは現在時刻を移動させながら過去 $\textrm{L}$ 時刻分の入力信号値の単純平均を出力するというだけのフィルタで、出力は次の計算で求められます。
</p>

<div class="info">
<input type="checkbox"><b>移動平均フィルタの出力: </b>

\begin{align*}
y[i]
& = \frac{ \sum_{n=0}^{\textrm{L-1}} x[i-n] }{\textrm{L}} \\
& = \sum_{n=0}^{ \textrm{L-1}} \left \{ \frac{1}{\textrm{L}} \cdot  x[i-n] \right \}
\end{align*}

</div>


<p>
この式は<a href="./page01.html">前ページ</a>で示した FIR フィルタの畳込み演算そのものですので、従って<a href="../text01/page03.html">インパルス応答</a>は次のようになります。
</p>

<div class="info">
<input type="checkbox"><b>(単純)移動平均フィルタのインパルス応答: </b>

<p>
移動平均フィルタ長として適当な正整数 $\textrm{L}$ を決める。
</p>

<p>
この時、移動平均フィルタのインパルス応答は次の式で表される。
</p>

\begin{align*}
h[i] = \frac{1}{\textrm{L}}\ ,\  (i = 0, 1, \cdots, \textrm{L}-1 )
\end{align*}

</div>

<p>
伝達関数はインパルス応答を<a href="../../z/">Z 変換</a>して次のようになります。
</p>

<div class="info">
<input type="checkbox"><b>移動平均フィルタの伝達関数: </b>

<p>　</p>

\begin{align*}
\textrm{H}(z) 
= \sum_{i=0}^{\textrm{L}-1} \{ \frac{1}{\textrm{L}} \cdot z^{-i} \}
\end{align*}


</div>


<p>
移動平均フィルタの<a href="../text01/page11.html">周波数特性</a>は次のようになります(※)。
<br>
ただし式を簡単にするために今回は $\textrm{L}$ は奇数とし、$\textrm{C} = (\textrm{L}-1)/2$ を定義しました。
</p>

<p>
※ この特性式の求め方はインパルス応答の遅延等を考える必要があって結構難しいので<a href="./page03.html">次ページ</a>でじっくりと説明します。
</p>

<div class="info">
<input type="checkbox"><b>移動平均フィルタの周波数特性: </b>

<p>
$\textrm{L}$ は奇数とし、$\textrm{C} = (\textrm{L}-1)/2$ とする。
</p>

\begin{align*}
\textrm{H}(w) = 
\left (
\frac{1}{\textrm{L}}
+ 
\sum_{i = 1}^{\textrm{C}} 
\left \{
2 \cdot 
\frac{1}{\textrm{L}} \cdot 
\cos (i\cdot w \cdot \tau )
\right \}
\right )
\cdot
\textrm{e}^{ -j \cdot w \cdot \textrm{C} \cdot \tau }
\end{align*}

</div>

<p>
この後<a href="./practice.html">演習</a>で確認しますが、移動平均フィルタの周波数特性はローパス特性になります。
<br>
ただしフィルタ長 $\textrm{L}$ が短いと緩慢な減衰特性になるので、高周波ノイズをきちんと取り除きたい場合はある程度の長さにしないといけません。
</p>

<br>
<script>PreNext(2,4)</script>
</body>
</html>
