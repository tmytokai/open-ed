<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0">
<link rel="stylesheet" href="../../../common.css">
<script src="../../../common.js"></script>
<script src="../../../mathjax.js"></script>
<title>2. (標本)自己相関関数</title>
</head>
<body>

<nav class="brcr">
<ol>
<li><a href="../">アクティビティ: 自己相関関数</a></li>
<li>学習項目: [1] 自己相関関数</li>
<li><script>GetTitle()</script></li>
</ol>
</nav>

<h2><script>GetTitle()</script></h2>

<p>
さて $f[i]$ が定常過程であるとき、自己相関関数は
</p>
\[
R[n] = \textrm{E}\left ( f[i] \cdot f[i+n] \right )
\]
<p>
により定義されます。
<br>
前ページの2つの例の様に、もし $f[i]$ の平均が 0 の場合は共分散と自己相関関数は一致します。
<br>
また自己相関関数も時刻 $i$ の値によらず遅延時刻 $n$ のみで値が決まる関数となります。
</p>

<p>
こうやって求めた $R[n]$ の値が相対的に大きい値の時、$f[i]$ とそこから時刻 $n$ だけ遅延させた $f[i+n]$ の間には強い相関があるということを意味します(前ページの図3と図7を参照して下さい)。
</p>

<p>
ところが $f[i]$ を生成したモデルや確率分布などは普通分かりませんし、仮に分かっていてもかなり複雑なモデルや分布になったりしますので、ディジタル信号処理の世界では実際に観測された $f[i]$ の値を使って求める「<b>標本自己相関関数</b>(sample autocorrelation function)」で代用することが多いです。
</p>

<div class="info">
<input type="checkbox"><b>定義: 標本自己相関関数:</b>

<p>
$f[i]$ の信号長を $\textrm{N}$ とした時
</p>

\[
R[n] = \frac{1}{\textrm{N}}\sum_{i = 0}^{\textrm{N-1}} 
\left \{
f[\ i\ ] \cdot f[\ (i+n)\ \textrm{mod}\ \textrm{N} \ ]
\right \}
\]

<p>
$n$・・・遅延時刻(ラグとも言う)、整数の変数、範囲は $n=0,1,\cdots,\textrm{N-1}$
</p>

<p>
A mod N・・・割った余りを求める剰余演算(modulo)、(例) 5 mod 2 = 1
</p>

<p>
※ 文献によっては $\sum$ の計算をしたあと全体を $\textrm{N}$ で割らない場合もあります
</p>

</div>

<p>
$n$ の範囲は $n=0,1,\cdots,\textrm{N-1}$ なので、自己相関関数も $R[0]$ から $R[\textrm{N}-1]$ までの信号長 N のディジタル信号になります。
</p>

<p>
なお $\textrm{R}[0]$ は
</p>

\[
R[0] = \frac{1}{\textrm{N}}\sum_{i = 0}^{\textrm{N-1}} 
\left \{
f[\ i\ ]
\right \}^2
\]

<p>
ですので信号の平均パワーを表します。
<br>
同じ信号列同士の相関になりますので $\textrm{R}[0]$ は $R[0]$ から $R[\textrm{N}-1]$ までの中で必ず最大値となります。
</p>

<p>
ではここで例として<a href="../../d-sin">ディジタルサイン波</a>
</p>

\[
f[i] = 1 \cdot \sin( 2\pi /5 \cdot i -\pi/2 )
\]

<p>
を N=10 点生成した信号を考えます。
<br>
実際に得られた信号が以下の図1です。
</p>

<div class="info">
<input type="checkbox"><b>図1: 元の信号 (最初の 10 点だけ表示)</b>
<p>　</p>
<img src="./img/page02-fig1.png" alt="">
</div>

<p>
この信号の自己相関関数のグラフが以下の図2です。
</p>

<div class="info">
<input type="checkbox"><b>図2: 図1の信号から求めた自己相関関数のグラフ (最初の 10 点だけ表示)</b>
<p>　</p>
<img src="./img/page02-fig2.png" alt="">
<p>
※ $R[0] = 1/2$ は振幅 1 のサイン波の平均パワー(= 実効値( $1/\sqrt{2}$ )の自乗)に相当します
</p>
</div>

<br>
<script>PreNext(2,5)</script>
</body>
</html>
