<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0">
<link rel="stylesheet" href="../../../common.css">
<script src="../../../common.js"></script>
<title>演習</title>
</head>
<body>

<nav class="brcr">
<ol>
<li><a href="../">アクティビティ: 入出力インターフェース</a></li>
<li>学習項目: [4] PWM</li>
<li><script>GetTitle()</script></li>
</ol>
</nav>

<h2><script>GetTitle()</script></h2>

<p>
演習時間: 40  分
</p>

<br>
<h2><a href="./page01.html">1. PWM とは</a></h2>

<p>
演習なし
</p>

<br>
<h2><a href="./page02.html">2. 出力</a></h2>

<pre>
T2CON = 0b 0 0000 1 xx  ・・・ Timer2 Control Register p153

PWMxCON = 0b 1 1 0 0 0000 ・・・PWMx Control Register p213

PWM周期とPWM幅の計算式 ・・・ p210

PWMxDCH ・・・ PWM DUTY CYCLE HIGH BITS p214
PWMxDCL ・・・ PWM DUTY CYCLE LOW BITS p214
PR2 ・・・ Timer2 Period Register

FOSC ・・・ Frequency of Oscillator マイコンの動作周波数のこと
TOSC ・・・ Time taken per OSCillation つまり = 1/FOSC 

</pre>

<pre>
(注意)  pickit4の出力は 3.3V

(1)

PR2 = 124
PWMxDCH:PWMxDCL<7:6> =  0b 01111101 11 = 375

の時の PWM周期とPWM幅の理論値を計算 → 実際にオシロスコープで確認する
</pre>

<pre>

(2)

圧電スピーカから「ド・レ・ミ」と鳴らす(3秒毎にチェンジ)

FOSC = 8000000
prescale = 64

        printf("O3C = 131 Hz\r\n");

        // PWM周期 = 131 Hz = 7.63 ミリ秒
        // パルス幅は PWM 周期の半分とする

        printf("O3E = 165 Hz\r\n");

        // PWM周期 = 165 Hz = 6.06 ミリ秒
        // パルス幅は PWM 周期の半分とする

        printf("O3G = 196 Hz\r\n");

        // PWM 周期 = 196 Hz = 5.10 ミリ秒
        // パルス幅は PWM 周期の半分とする
</pre>

<script>PreNext(3,2)</script>
</body>
</html>
