<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0">
<link rel="stylesheet" href="../../../common.css">
<script src="../../../common.js"></script>
<title>3. TensorFlow の仕組み</title>
</head>
<body>

<nav class="brcr">
<ol>
<li><a href="../">アクティビティ: TensorFlow によるディープラーニング</a></li>
<li>学習項目: [1] TensorFlow の基本</li>
<li><script>GetTitle()</script></li>
</ol>
</nav>

<h2><script>GetTitle()</script></h2>

<br>
<h3>
1.データフローグラフ
</h3>

<p>
TensorFlow はデータフロープログラミング型の言語です。データフロープログラミングでは Java や C/C++ の様な命令型プログラミングと異なって、まず事前に「データフローグラフ」と呼ばれるグラフを作り、その後グラフにデータを入力することで結果が出力されるという流れでプログラムを動かします。なお TensorFlow で扱うデータ形式は前のページで説明した「テンソル」です。
</p>

<p>
ここで TensorFlow の「データフローグラフ」の例を図1に示します。図1の ○ を OP ノード、OP ノード間をつないでいる矢印の事をエッジと言います。エッジの上を矢印の方向に向かってテンソルが流れる(フローする)事からテンソルフローという名前が付けられたのだと思います(多分)。
</p>

<div class="info">
<input type="checkbox"><b>図1: データフローグラフの例: </b>

<p>
○ ・・・ OP ノード: 入力されたテンソルに対して演算処理を行い、演算結果のテンソルを出力する
<br>
矢印・・エッジ: テンソルが矢印の方向に流れる
</p>

<img src="./img/page03-fig1.png" alt="">

</div>

<br>
<h3>
2.OP ノード
</h3>

<p>
OP ノードについてもう少し詳しく説明します。OP ノードは「オペレーション(OPeration)ノード」の略で、図 1 内で書いたように入力側のエッジを通って流れてきたテンソルに何らかの演算処理を行なって、その結果をまたテンソルとして出力側のエッジに流す役割を持っています。
</p>

<p>
入力出力エッジは図 1 では 1 本だけでしたが、実際には 0 本から複数本まで入力可能です(図2)。
</p>

<div class="info">
<input type="checkbox"><b>図2: OP ノードはテンソルを複数本入出力可能: </b>

<p>
※ 出力テンソルは全て同じ値になる
</p>

<img src="./img/page03-fig2.png" alt="">
</div>

<p>
この OP ノードの種類は沢山あるのですが、次のページ以降で今回のアクティビティで使う OP ノードをコード例も示しながら説明します。
</p>

<br>
<h3>
3. セッション
</h3>

<p>
具体的な OP ノードの説明をする前にここではセッションについても説明をしておきます。
</p>

<p>
TensorFlow は最初に書いたようにまず事前に「データフローグラフ」を作り、それからグラフにデータを入力するという 2 段構えでプログラムを実行します。このプログラムを動かす仕組みの事を「セッション」と呼んでいます。
</p>

<p>
セッションの具体例として、以前示したハローワールドのコードを使って説明します。
</p>

<div class="info">
<input type="checkbox"><b>コード1: TensorFlow のハローワールド(再掲):</b>

<pre class="wrap">
#coding: UTF-8
import tensorflow as tf
sess = tf.Session()

op_const = tf.constant( 123 )

result = sess.run( op_const )
print( result )
# 表示結果
# 123
</pre>
</div>

<p>
まず最初の import 文で TensorFlow モジュールをインポートした後、早速 sess という名の Session オブジェクトを作ります。
</p>

<p>
次に(話が前後して申し訳ありませんが次のページで説明する)定数 OP ノードを op_const という名のオブジェクトとして作ります。今回は OP ノードが op_const ひとつだけのデータフローグラフになります(図3)。
</p>

<div class="info">
<input type="checkbox"><b>図3: ハローワールドのデータプローグラフ: </b>

<p>
<img src="./img/page03-fig3.png" alt="">
</p>
</div>

<p>
さてグラフを作ったので sess.run() 関数でセッションを開始します。すると先頭の OP ノードから run のカッコ内で指定した OP ノードまでテンソルが流れて(今回は op_const しか無いので op_const から始まって op_const で終わりです)、その演算結果が result オブジェクトに入ります。
</p>

<script>PreNext(3,5)</script>
</body>
</html>
