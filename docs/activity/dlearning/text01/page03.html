<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0">
<link rel="stylesheet" href="../../../common.css">
<script src="../../../common.js"></script>
<title>3. TensorFlow の仕組み</title>
</head>
<body>

<nav class="brcr">
<ol>
<li><a href="../">アクティビティ: TensorFlow によるディープラーニング</a></li>
<li>学習項目: [1] TensorFlow の基本</li>
<li><script>GetTitle()</script></li>
</ol>
</nav>

<h2><script>GetTitle()</script></h2>

<br>
<h3>
1.データフロー・グラフ
</h3>

<p>
TensorFlow はデータフロー・プログラミング型の言語です。
</p>

<p>
データフロー・プログラミングでは Java や C/C++ の様な命令型プログラミングと異なって、まず事前に「データフロー・グラフ」と呼ばれるグラフを作り、その後グラフにデータを入力することで結果が出力されるという流れでプログラムを動かします。
<br>
なお TensorFlow で扱うデータ形式は前のページで説明した「テンソル」です。
</p>

<p>
ここで TensorFlow の「データフローグラフ」の例を図1に示します。
<br>
図1の ○ を「<b>オペレーション (operation、略して OP)</b>」(※)、オペレーション間をつないでいる矢印の事を「<b>エッジ (edge)</b>」と言います。
<br>
エッジの上を矢印の方向に向かってテンソルが流れます。
</p>

<p>
※ 一般的なデータフロー・グラフでは「ノード」と呼んでいますが、TensorFlow では「オペレーション」と呼んでいます。
</p>

<div class="info">
<input type="checkbox"><b>図1: データフローグラフの例: </b>

<p>
○ ・・・ オペレーション (OP): 入力されたテンソルに対して演算処理を行い、演算結果のテンソルを出力する
</p>

<p>
矢印・・・エッジ : テンソルが矢印の方向に流れる
</p>

<img src="./img/page03-fig1.png" alt="">

</div>

<br>
<h3>
2.オペレーション (OP)
</h3>

<p>
オペレーション (以下 OP)についてもう少し詳しく説明します。
</p>

<p>
OP は入力側のエッジを通って流れてきたテンソルに何らかの演算処理を行なって、その結果をまたテンソルとして出力側のエッジに流す役割を持っています。
<br>
入力出力エッジは図 1 では 1 本だけでしたが、実際には 0 本から複数本まで入力可能です(図2)。
</p>

<div class="info">
<input type="checkbox"><b>図2: OP はテンソルを複数本入出力可能: </b>

<p>
※ 出力テンソルは全て同じ値になる
</p>

<img src="./img/page03-fig2.png" alt="">
</div>

<p>
次のページ以降で今回のアクティビティで使う OP をコード例も示しながら説明します。
</p>

<br>
<h3>
3. セッション
</h3>

<p>
TensorFlow は最初に書いたようにまず事前に複数の OP とエッジを組み合わせて「データフロー・グラフ」を作り、それからグラフにデータを入力するという 2 段構えでプログラムを実行します。
<br>
このプログラムを動かす仕組みの事を「セッション」と呼んでいます。
</p>

<p>
セッションの具体例として、<a href="./page01.html">最初のページ</a>で示したハローワールドのコードを使って説明します。
</p>

<div class="info">
<input type="checkbox"><b>コード1: TensorFlow のハローワールド(再掲):</b>

<pre class="wrap">
#coding: UTF-8
import sys
import tensorflow as tf

print(sys.version_info) # pythonのバージョン表示
print(tf.__version__)  # TensorFlowのバージョン表示

sess = tf.Session() # セッション作成

op_const = tf.constant( 123 )

result = sess.run( op_const )
print( result )

# 表示結果
# (pythonのバージョン)
# (TensorFlowのバージョン)
# 123
</pre>
</div>

<p>
まず最初の import 文で TensorFlow モジュールをインポートし、バージョン表示後に sess という名の Session オブジェクトを作っています。
</p>

<p>
次に次のページで説明する<a href="./page04.html#const">定数 OP</a> を op_const という名のオブジェクトとして作ります。
<br>
よって今回は OP が op_const ひとつだけのデータフロー・グラフになります(図3)。
</p>

<div class="info">
<input type="checkbox"><b>図3: ハローワールドのデータプローグラフ: </b>

<p>
<img src="./img/page03-fig3.png" alt="">
</p>
</div>

<p>
さてグラフを作ったので sess.run() 関数でセッションを開始します。
<br>
すると先頭の OP から run のカッコ内で指定した OP までテンソルが流れて(今回は op_const しか無いので op_const から始まって op_const で終わりです)、その演算結果が result オブジェクトに入ります。
</p>

<script>PreNext(3,5)</script>
</body>
</html>
