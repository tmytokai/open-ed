<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0">
<link rel="stylesheet" href="../../../common.css">
<script src="../../../common.js"></script>
<script src="../../../mathjax.js"></script>
<title>2. フーリエ変換とフーリエ級数展開の関係</title>
</head>
<body>

<nav class="brcr">
<ol>
<li><a href="../">アクティビティ: フーリエ変換</a></li>
<li>学習項目: [1] フーリエ変換</li>
<li><script>GetTitle()</script></li>
</ol>
</nav>

<h2><script>GetTitle()</script></h2>

<p>
フーリエ変換はテキストなどでは<a href="../../fourier/">複素フーリエ級数展開</a>の周期 $\textrm{T}$ [秒]を無限大にした物と説明されることが多いのですが、真面目に考えるとそれ程単純な話ではありません。
</p>

<p>
複素フーリエ級数展開とフーリエ変換、及びその元となる周期的なアナログ信号と非周期的なアナログ信号の間の関係は意外に複雑で、その関係を相関図にして示したのが図1です。
</p>

<div class="info">
<input type="checkbox"><b>図1: 複素フーリエ級数展開とフーリエ変換の相関図</b>

<p>
準備中
</p>

</div>

<p>
図1に示した関係について以下でじっくり説明して行きたいと思います。
</p>

<br>
<h2>
(1) 非周期的なアナログ信号 → 周期的なアナログ信号
</h2>

<p>
まず基本となる「非周期的なアナログ信号 → 周期的なアナログ信号」の経路から説明します。
</p>

<div class="info">
<input type="checkbox"><b> 非周期的なアナログ信号 → 周期的なアナログ信号</b>

<p>
$f(t)$ を $ -\textrm{T}/2 \leq t \leq \textrm{T}/2$ 以外の時刻は 0 である長さ $\textrm{T}$ [秒]の非周期的な時間領域アナログ信号とする。
</p>

<p>
i を整数とし、$f(t)$ を $i \cdot \textrm{T}$ [秒] だけずらした信号を無限に足し合わせた
</p>

\[
f_{pd}(t) = \sum_{i=-\infty}^{\infty} \ f(t - i \cdot \textrm{T})
\]

<p>
※ pd は periodic(周期的) の略です。
</p>

<p>
は周期 $\textrm{T}$ [秒]、基本角周波数 $w_1 = 2\pi/\textrm{T}$ [rad/秒]  の周期的な時間領域アナログ信号となる。
</p>

</div>

<p>
もちろん信号の長さが無限の時は周期的な信号を作れませんので、今回は $\textrm{T}$ は有限の範囲内だけで考えることにします。
</p>


<br>
<h2>
(2) 周期的なアナログ信号 → 非周期的なアナログ信号
</h2>

<p>
次は(1)の逆の経路です。
</p>

<div class="info">
<input type="checkbox"><b> 周期的なアナログ信号 → 非周期的なアナログ信号</b>

<p>
$f_{pd}(t)$ を周期 $\textrm{T}$ [秒]、基本角周波数 $w_1 = 2\pi/\textrm{T}$ [rad/秒] の周期的な時間領域アナログ信号とする。
</p>


<p>
さらに矩形状の窓関数
</p>

\[
\textrm{rect}(t) = 
\begin{cases}
0 \ & t < -\frac{\textrm{T}}{2} \\[10pt]
1 \ & -\frac{\textrm{T}}{2} \leq t \leq \frac{\textrm{T}}{2} \\[10pt]
0 & t > \frac{\textrm{T}}{2}
\end{cases}
\]

<p>
※ rect は rectangle(矩形) の略です。
</p>

<p>
を定義する。
</p>

<p>
$f_{pd}(t)$ に $\textrm{rect}(t)$ をかけた信号
</p>


\[
f(t)
=
f_{pd}(t) \cdot \textrm{rect}(t)
=
\begin{cases}
0 \ & t < -\frac{\textrm{T}}{2} \\[10pt]
f_{pd}(t) \ & -\frac{\textrm{T}}{2} \leq t \leq \frac{\textrm{T}}{2} \\[10pt]
0 & t > \frac{\textrm{T}}{2}
\end{cases}
\]


<p>
は $f_{pd}(t)$ から  1 周期分だけ切り出した長さ $\textrm{T}$ [秒]の非周期的な時間領域アナログ信号となる。
</p>

</div>

<p>
なお、いきなり周期 $\textrm{T}$ が無限大の状況を考えると色々問題が生じますので、とりあえず今のところは $\textrm{T}$ は有限の範囲内だけで考えることにします(一番最後に $\textrm{T} \rightarrow \infty$ の場合について少しだけ触れます)。
</p>

<br>
<h2>
(3) フーリエ変換 → 複素フーリエ係数
</h2>

<p>
では本題の一つである「フーリエ変換 → 複素フーリエ係数」の経路について説明します。
</p>

<div class="info">
<input type="checkbox"><b> フーリエ変換 → 複素フーリエ係数</b>

<p>
$f(t)$ を $ -\textrm{T}/2 \leq t \leq \textrm{T}/2$ 以外の時刻は 0 である長さ $\textrm{T}$ [秒]の非周期的な時間領域アナログ信号とする。
<br>
また $f(t)$ のフーリエ変換を $\textrm{F}(w)$ とする。
</p>

<p>
同様に $f_{pd}(t)$ を $f(t)$ をもとにして作った周期 $\textrm{T}$ [秒]、基本角周波数 $w_1 = 2\pi/\textrm{T}$ [rad/秒] の周期的な時間領域アナログ信号とする。
<br>
また $\textrm{C}[k]$ を $f_{pd}(t)$ から求めた複素フーリエ係数とする。
</p>

<p>
この時、複素フーリエ係数とフーリエ変換には次の関係が成り立つ。
</p>

\[
\textrm{C}[k] = \frac{1}{\textrm{T}} \cdot \textrm{F} ( k \cdot w_1 )
\]

</div>

<p>
要するに
</p>

<p>
<b>$\textrm{C}[k]$ は $\textrm{F}(w)$ を $w_1$ おきにサンプリングし $\textrm{T}$で割って作ったディジタル信号列</b>
</p>

<p>
ということです。
</p>

<p>
これは複素フーリエ係数の定義を使って次の様に簡単に証明することが出来ます。
</p>

\begin{align*}
\textrm{F}( k \cdot w_1) 
& = 
\int_{-\infty}^{\infty}
\left \{
f(t) \cdot \textrm{e}^{\{-j \cdot k \cdot w_1 \cdot t \}} 
\right \} 
\textrm{d}t \\[10pt]
& = 
\int_{-\textrm{T}/2}^{\textrm{T}/2}
\left \{
f(t) \cdot \textrm{e}^{\{-j \cdot k \cdot w_1 \cdot t \}} 
\right \} 
\textrm{d}t \\[10pt]
(\text{複素フーリエ係数の定義より})& = \textrm{T} \cdot \textrm{C}[k]
\end{align*}

</div>


<br>
<h2>
(4) フーリエ変換 → インパルス列
</h2>

<p>
次はもう一つの本題である「複素フーリエ係数 → フーリエ変換」の経路について説明したいところなのですが、こちらは簡単に説明することが出来ません。
<br>
そこで「インパルス列」という信号を新たに導入して「フーリエ変換 → インパルス列」の経路について先に説明します。
</p>

<p>
なお、突然「インパルス列」という謎の用語が出てきましたが、これについて詳しく説明するためにはサンプリング理論の話をイチからしないといけないので今回はあまり深く立ち入らないことにします。
<br>
興味のある人はインパルス列について自分で調べてください。
</p>

<div class="info">
<input type="checkbox"><b> フーリエ変換 → インパルス列</b>

<p>
$f(t)$ を $ -\textrm{T}/2 \leq t \leq \textrm{T}/2$ 以外の時刻は 0 である長さ $\textrm{T}$ [秒]の非周期的な時間領域アナログ信号とする。
<br>
また $f(t)$ のフーリエ変換を $\textrm{F}(w)$ とする。
<br>
さらに周波数領域内でサンプリング間隔 $w_1 = 2\pi/\textrm{T}$ [rad/秒] おきに<a href="https://ja.wikipedia.org/wiki/%E3%83%87%E3%82%A3%E3%83%A9%E3%83%83%E3%82%AF%E3%81%AE%E3%83%87%E3%83%AB%E3%82%BF%E9%96%A2%E6%95%B0">デルタ関数</a> $\delta(t)$ をくし(櫛)上に並べた信号
</p>

\[
\textrm{comb}(w) = \sum_{k=-\infty}^{\infty} \delta(w-k\cdot w_1)
\]

<p>
※ comb はくしの英文です。
</p>

<p>
を定義する。
<br>
この信号は「<b><a href="https://ja.wikipedia.org/wiki/%E3%81%8F%E3%81%97%E5%9E%8B%E9%96%A2%E6%95%B0">くし型関数</a></b>」と呼ばれる。
</p>

<p>
この時、$\textrm{F}(w)$ にくし型関数 $\textrm{comb}(w)$ をかけて作った信号
</p>

\begin{align*}
\textrm{F}_{imp}(w)
&=
\textrm{F}(w) \cdot  \textrm{comb}(w) \\[10pt]
&=
\textrm{F}(w) \cdot 
\sum_{k=-\infty}^{\infty} \ \delta(w - k \cdot w_1 ) \\[10pt]
&=
\sum_{k=-\infty}^{\infty} \ \textrm{F}(k \cdot w_1) \cdot  \delta(w - k \cdot w_1 )

\end{align*}

<p>
※ imp は impulse の略です。
</p>

<p>
のことを「<b>$\textrm{F}(w)$ をサンプリングして生成したインパルス列</b>」と呼ぶ。
</p>

</div>

<p>
ここでサンプリング間隔を $w_1 = 2\pi/\textrm{T}$ [rad/秒] としていますので、サンプリング角周波数は $\textrm{T}$ [秒]、ナイキスト角周波数は $\textrm{T}$/2 [秒]となります。
</p>

<p>
※ ちょっとややこしいのですが、周波数領域内でサンプリングしているのでサンプリング／ナイキスト角周波数の単位は [秒] になります。
</p>

<p>
よって $f(t)$ が $ -\textrm{T}/2 \leq t \leq \textrm{T}/2$ の範囲で帯域制限されていれば $\textrm{F}(w)$ をサンプリングする際にエイリアシングが生じない訳ですが、都合の良いことに $f(t)$ はそうなる様に定義したので、今回のサンプリングでエイリアシングは生じてないということが分かります。
</p>


<br>
<h2>
(5) 複素フーリエ係数 → インパルス列
</h2>

<p>
(3)と(4) から即座に次の事が言えます。
</p>

<div class="info">
<input type="checkbox"><b> 複素フーリエ係数 → インパルス列</b>

<p>
$f(t)$ を $ -\textrm{T}/2 \leq t \leq \textrm{T}/2$ 以外の時刻は 0 である長さ $\textrm{T}$ [秒]の非周期的な時間領域アナログ信号とする。
<br>
また $f(t)$ のフーリエ変換を $\textrm{F}(w)$ とする。
<br>
更に $\textrm{F}(w)$ をサンプリング間隔 $w_1 = 2\pi/\textrm{T}$ [rad/秒] でサンプリングして生成したインパルス列を $\textrm{F}_{imp}(w)$ とする。
</p>

<p>
同様に $f_{pd}(t)$ を $f(t)$ をもとにして作った周期 $\textrm{T}$ [秒]、基本角周波数 $w_1 = 2\pi/\textrm{T}$ [rad/秒] の周期的な時間領域アナログ信号とする。
<br>
また $\textrm{C}[k]$ を $f_{pd}(t)$ から求めた複素フーリエ係数とする。
</p>

<p>
この時、次の関係が成り立つ。
</p>

\[
\textrm{F}_{imp}(w)
=
\sum_{k=-\infty}^{\infty} \ \textrm{T} \cdot \textrm{C}[k] \cdot \delta(w - k \cdot w_1 )
\]

</div>

<br>
<h2>
(6) インパルス列 → 複素フーリエ係数
</h2>

<p>
(5) の逆経路です。
</p>

<div class="info">
<input type="checkbox"><b> インパルス列 → 複素フーリエ係数</b>

<p>
$f(t)$ を $ -\textrm{T}/2 \leq t \leq \textrm{T}/2$ 以外の時刻は 0 である長さ $\textrm{T}$ [秒]の非周期的な時間領域アナログ信号とする。
<br>
また $f(t)$ のフーリエ変換を $\textrm{F}(w)$ とする。
<br>
更に $\textrm{F}(w)$ をサンプリング間隔 $w_1 = 2\pi/\textrm{T}$ [rad/秒] でサンプリングして生成したインパルス列を $\textrm{F}_{imp}(w)$ とする。
</p>

<p>
同様に $f_{pd}(t)$ を $f(t)$ をもとにして作った周期 $\textrm{T}$ [秒]、基本角周波数 $w_1 = 2\pi/\textrm{T}$ [rad/秒] の周期的な時間領域アナログ信号とする。
<br>
また $\textrm{C}[k]$ を $f_{pd}(t)$ から求めた複素フーリエ係数とする。
</p>

<p>
すると次の関係が成り立つ。
</p>


\[
\textrm{C}[k] = \frac{ \textrm{F}_{imp}(k\cdot w_1) }{ \textrm{T} \cdot \delta(0) }
\]

</div>

<p>
$\delta(0)$ で割ってる部分がイメージしにくいのですが、要するに $\textrm{T} \cdot \textrm{C}[k] \cdot \delta(w - k \cdot w_1 )$ からデルタ関数を取り除いて $\textrm{T}$ で割れば $\textrm{C}[k]$ になるということです。
</p>


<br>
<h2>
(7) インパルス列 → 周期的なアナログ信号
</h2>

<p>
次に(4)で定義したインパルス列を逆フーリエ変換することで(1)で定義した周期的なアナログ信号が復元されることについて説明します。
</p>

<div class="info">
<input type="checkbox"><b> インパルス列 → 周期的なアナログ信号</b>

<p>
$f(t)$ を $ -\textrm{T}/2 \leq t \leq \textrm{T}/2$ 以外の時刻は 0 である長さ $\textrm{T}$ [秒]の非周期的な時間領域アナログ信号とする。
<br>
また $f(t)$ のフーリエ変換を $\textrm{F}(w)$ とする。
<br>
更に $\textrm{F}(w)$ をサンプリング間隔 $w_1 = 2\pi/\textrm{T}$ [rad/秒] でサンプリングして生成したインパルス列を $\textrm{F}_{imp}(w)$ とする。
</p>

<p>
同様に $f_{pd}(t)$ を $f(t)$ をもとにして作った周期 $\textrm{T}$ [秒]、基本角周波数 $w_1 = 2\pi/\textrm{T}$ [rad/秒] の周期的な時間領域アナログ信号とする。
</p>

<p>
このとき
</p>

\[
w_1 \cdot \textrm{F}_{imp}(w)
\]

<p>
を逆フーリエ変換することで  $f_{pd}(t)$ が復元される。
</p>

</div>

<p>
逆に言えば $f_{pd}(t)$ のフーリエ変換は $w_1  \cdot \textrm{F}_{imp}(w) $ だということです。
</p>

<p>
では証明してみましょう。
</p>

<p>
とりあえず $w_1 \cdot \textrm{F}_{imp}(w)$ の逆フーリエ変換を計算してみます。
<br>
すると
</p>

\begin{align*}
\frac{1}{2\pi}
\int_{-\infty}^{\infty}
\left \{
w_1 \cdot \textrm{F}_{imp}(w) \cdot \textrm{e}^{\{j \cdot w \cdot t \}} 
\right \}
\textrm{d}w

&=
\int_{-\infty}^{\infty}
\left \{
\frac{w_1}{2\pi}
\cdot 
\sum_{k=-\infty}^{\infty} \ \textrm{F}( k \cdot w_1) \cdot  \delta(w - k \cdot w_1 )
\cdot \textrm{e}^{\{j \cdot w \cdot t \}} 
\right \}
\textrm{d}w \\[10pt]

(w_1 = 2\pi/\textrm{T} \text{を代入})
&=
\int_{-\infty}^{\infty}
\left \{
\frac{1}{\textrm{T}}
\cdot 
\sum_{k=-\infty}^{\infty} \ \textrm{F}( k \cdot w_1) \cdot \delta(w - k \cdot w_1 )
\cdot \textrm{e}^{\{j \cdot w \cdot t \}} 
\right \}
\textrm{d}w \\[10pt]

(\text{積分と総和を入れ替え})
&=
\sum_{k=-\infty}^{\infty}
\left [
\frac{1}{\textrm{T}}
\cdot 
\textrm{F}( k \cdot w_1) \cdot 
\int_{-\infty}^{\infty}
\left \{
\delta(w - k \cdot w_1 )
\cdot \textrm{e}^{\{j \cdot w \cdot t \}} 
\right \}
\textrm{d}w 
\right ]
\\[10pt]

(\text{デルタ関数の性質より})
&=
\sum_{k=-\infty}^{\infty}
\left \{
\frac{1}{\textrm{T}}
\cdot 
\textrm{F}(k\cdot w_1) \cdot \textrm{e}^{\{j \cdot k \cdot w_1 \cdot t \}} 
\right \}
\\[10pt]

(\textrm{C}[k] = \frac{1}{\textrm{T}} \cdot \textrm{F} ( k \cdot w_1 ) \text{を代入})
&= \sum_{k = -\infty}^{\infty} 
\left \{
\textrm{C}[k] \cdot \textrm{e}^{\{j \cdot k \cdot w_1 \cdot t \}}
\right \} \\[10pt]

(\text{複素フーリエ級数展開なので})
&= f_{pd}(t) 
\end{align*}

<p>
となります。
</p>

<br>
<h2>
(8) 周期的なアナログ信号 → インパルス列
</h2>

<p>
(7) から即座に次の事が言えます。
</p>

<div class="info">
<input type="checkbox"><b> 周期的なアナログ信号 → インパルス列</b>

<p>
$f(t)$ を $ -\textrm{T}/2 \leq t \leq \textrm{T}/2$ 以外の時刻は 0 である長さ $\textrm{T}$ [秒]の非周期的な時間領域アナログ信号とする。
<br>
また $f(t)$ のフーリエ変換を $\textrm{F}(w)$ とする。
<br>
更に $\textrm{F}(w)$ をサンプリング間隔 $w_1 = 2\pi/\textrm{T}$ [rad/秒] でサンプリングして生成したインパルス列を $\textrm{F}_{imp}(w)$ とする。
</p>

<p>
同様に $f_{pd}(t)$ を $f(t)$ をもとにして作った周期 $\textrm{T}$ [秒]、基本角周波数 $w_1 = 2\pi/\textrm{T}$ [rad/秒] の周期的な時間領域アナログ信号とする。
</p>

<p>
この時
</p>

\[
\frac{ 1 }{ w_1 } \cdot f_{pd}(t)
\]

<p>
をフーリエ変換することで $\textrm{F}_{imp}(w)$ が得られる。
</p>

</div>

<p>
さて(7)と(8)の話から
</p>

<p>
<b>非周期的なアナログ信号のフーリエ変換をインパルス列化すると時間領域では周期的なアナログ信号になる</b>
</p>

<p>
という法則があることが分かります。
<br>
同様に
</p>

<p>
<b>(周期的か非周期的を問わず)アナログ信号をインパルス列化するとフーリエ変換は周期的になる</b>
</p>

<p>
という法則もあるのですが、これについてはここでは詳しく説明しないので、興味があったら<a href="../../z/text01/page02.html">こちら</a>を参考にしてください。
</p>



<br>
<h2>
(9) インパルス列 → フーリエ変換
</h2>

<p>
次は「インパルス列 → フーリエ変換」の経路について説明します。
</p>

<div class="info">
<input type="checkbox"><b> インパルス列 → フーリエ変換</b>

<p>
$f(t)$ を $ -\textrm{T}/2 \leq t \leq \textrm{T}/2$ 以外の時刻は 0 である長さ $\textrm{T}$ [秒]の非周期的な時間領域アナログ信号とする。
<br>
また $f(t)$ のフーリエ変換を $\textrm{F}(w)$ とする。
<br>
更に $\textrm{F}(w)$ をサンプリング間隔 $w_1 = 2\pi/\textrm{T}$ [rad/秒] でサンプリングして生成したインパルス列を $\textrm{F}_{imp}(w)$ とする。
</p>

<p>
この時 $\textrm{F}(w)$ は $w_1 \cdot \textrm{F}_{imp}(w)$ と
</p>

\[
\textrm{T} \cdot \textrm{sinc} \frac{ w \cdot \textrm{T} }{2} = \textrm{T} \cdot \frac{ \sin \left ( w \cdot \textrm{T} \right ) }{\left ( w \cdot \textrm{T} \right )}
\]

<p>
の畳み込み演算により求まる。
<br>
ここで sinc は<a href="https://ja.wikipedia.org/wiki/Sinc%E9%96%A2%E6%95%B0">非正規化 sinc 関数</a>である。
<br>
すなわち
</p>

\begin{align*}
\textrm{F}(w) 
&= 
\frac{1}{2\pi} \cdot
\left (
w_1 \cdot \textrm{F}_{imp}(w) * \textrm{T} \cdot \textrm{sinc} \frac{ w \cdot \textrm{T} }{2} 
\right ) \\[10pt]
\end{align*}

<p>
※ 式中の * は畳み込み積分です。
</p>


</div>

<p>
この関係は $\textrm{F}_{imp}(w)$ に対して理想ローパスフィルタ処理を行う処理、つまり (2) で時間領域内で行っている処理を周波数領域内で考えることで証明できます。
</p>

<p>
(証明は省略しますが) $\textrm{rect}(t)$ のフーリエ変換は
</p>

\[
\textrm{T} \cdot \textrm{sinc} \frac{ w \cdot \textrm{T} }{2} 
\]

<p>
ですので、この式と $f_{pd}(t)$ のフーリエ変換である $w_1 \cdot \textrm{F}_{imp}(w)$ を畳み込めば $f(t) = f_{pd}(t) \cdot \textrm{rect}(t)$ のフーリエ変換 $\textrm{F}(w)$ が出てきます。
<br>
なお(4)で説明したように $\textrm{F}(w)$ をサンプリングして $\textrm{F}_{imp}(w)$ を作る際にエイリアシングは生じてませんので、この畳み込み演算により $\textrm{F}(w)$は完全復元されます。
</p>

<br>
<h2>
(10) 複素フーリエ係数 → フーリエ変換
</h2>

<p>
これで準備が整いましたので、いよいよ残った本題である「複素フーリエ係数 → フーリエ変換」の経路について説明します。
</p>

<div class="info">
<input type="checkbox"><b>複素フーリエ係数 → フーリエ変換</b>

<p>
$f(t)$ を $ -\textrm{T}/2 \leq t \leq \textrm{T}/2$ 以外の時刻は 0 である長さ $\textrm{T}$ [秒]の非周期的な時間領域アナログ信号とする。
<br>
また $f(t)$ のフーリエ変換を $\textrm{F}(w)$ とする。
</p>

<p>
同様に $f_{pd}(t)$ を $f(t)$ をもとにして作った周期 $\textrm{T}$ [秒]、基本角周波数 $w_1 = 2\pi/\textrm{T}$ [rad/秒] の周期的な時間領域アナログ信号とする。
<br>
また $\textrm{C}[k]$ を $f_{pd}(t)$ から求めた複素フーリエ係数とする。
</p>

<p>
この時、 $\textrm{C}[k]$ に対して sinc 補間(理想ローパスフィルタ処理)をおこなうと $\textrm{F}(w)$ が得られる。
<br>
すなわち
</p>

\[
\textrm{F}(w)  = \textrm{T} \cdot 
\sum_{k=-\infty}^{\infty}
\textrm{C}[k] \cdot 
\textrm{sinc} \frac{ (w - k \cdot w_1) \cdot \textrm{T} }{2} 
\]

</div>

<p>
この証明は(9)の畳み込み演算の続きを計算すると出来ます。
<br>
ではやってみましょう。
</p>

\begin{align*}

\textrm{F}(w)
&=
\frac{1}{2\pi} \cdot
\left (
w_1 \cdot \textrm{F}_{imp}(w) * \textrm{T} \cdot \textrm{sinc} \frac{ w \cdot \textrm{T} }{2} 
\right ) \\[10pt]

&=
\frac{1}{2\pi} \cdot
\int_{-\infty}^{\infty}
w_1 \cdot
\textrm{F}_{imp}(\xi) 
\cdot \textrm{T} \cdot \textrm{sinc} \frac{ (w - \xi) \cdot \textrm{T} }{2} 
\ \textrm{d}\xi \\[10pt]

&=
\int_{-\infty}^{\infty}
\sum_{k=-\infty}^{\infty} 
\
\frac{w_1}{2\pi} \cdot
\textrm{F}(k \cdot w_1) 
\cdot
 \delta(\xi - k \cdot w_1 )
\cdot \textrm{T} \cdot \textrm{sinc} \frac{ (w - \xi) \cdot \textrm{T} }{2} 
\ \textrm{d}\xi \\[10pt]

(w_1 = 2\pi/\textrm{T} \text{を代入})
&=
\int_{-\infty}^{\infty}
\sum_{k=-\infty}^{\infty} 
\
\frac{1}{\textrm{T}} \cdot
\textrm{F}(k \cdot w_1) 
\cdot
 \delta(\xi - k \cdot w_1 )
\cdot \textrm{T} \cdot \textrm{sinc} \frac{ (w - \xi) \cdot \textrm{T} }{2} 
\ \textrm{d}\xi \\[10pt]

(\textrm{C}[k] = \frac{1}{\textrm{T}} \cdot \textrm{F} ( k \cdot w_1 ) \text{を代入})
&=
\int_{-\infty}^{\infty}
\sum_{k=-\infty}^{\infty}
\textrm{C}[k] \cdot \delta(\xi - k \cdot w_1 ) \cdot \textrm{T} \cdot \textrm{sinc} \frac{ (w - \xi) \cdot \textrm{T} }{2} 
\ \textrm{d}\xi \\[10pt]

(\text{積分と総和を入れ替え})
&=
\textrm{T} \cdot 
\sum_{k=-\infty}^{\infty}
\left [
\textrm{C}[k] \cdot 
\int_{-\infty}^{\infty}
\delta(\xi - k \cdot w_1 ) \cdot \textrm{T} \cdot \textrm{sinc} \frac{ (w - \xi) \cdot \textrm{T} }{2} 
\ \textrm{d}\xi 
\right ]
\\[10pt]

(\text{デルタ関数の性質より})
&=
\textrm{T} \cdot 
\sum_{k=-\infty}^{\infty}
\textrm{C}[k] \cdot 
\textrm{sinc} \frac{ (w - k \cdot w_1) \cdot \textrm{T} }{2} 

\end{align*}

<p>
と求まりました。
</p>

<p>
ここで参考までに簡単な例を示しましょう。
</p>

\[
f_{pd}(t) = \sin (w_1\cdot t )
\]

<p>
の時、複素フーリエ係数はオイラー公式より
</p>

\[
\begin{cases}
\textrm{C}[1] = \frac{1}{2j} \\[10pt]
\textrm{C}[-1] = -\frac{1}{2j} \\[10pt]
\textrm{C}[k] = 0 \ (k \ne \pm1)
\end{cases}
\]

<p>
です。
</p>

<p>
一方、
</p>

\[
f(t) = f_{pd}(t) \cdot \textrm{rect}(t) = 
\begin{cases}
0 \ & t < -\frac{\textrm{T}}{2} \\[10pt]
\sin(w_1\cdot t) \ & -\frac{\textrm{T}}{2} \leq t \leq \frac{\textrm{T}}{2} \\[10pt]
0 & t > \frac{\textrm{T}}{2}
\end{cases}
\]

<p>
のフーリエ変換は(証明は省略しますが)
</p>

\[
\textrm{F}(w) 
=
\frac{\textrm{T}}{2j} \cdot \textrm{sinc} \frac{ (w - w_1) \cdot \textrm{T} }{2} 
-
\frac{\textrm{T}}{2j} \cdot \textrm{sinc} \frac{ (w + w_1) \cdot \textrm{T} }{2} 
\]

<p>
です。
<br>
よって
</p>

\[
\textrm{F}(w) 
=
\textrm{T} \cdot \textrm{C}[1] \cdot \textrm{sinc} \frac{ (w - w_1) \cdot \textrm{T} }{2} 
+
\textrm{T} \cdot \textrm{C}[-1] \cdot \textrm{sinc} \frac{ (w + w_1) \cdot \textrm{T} }{2} 
\]

<p>
であることが分かります。
</p>


<br>
<h2>
(11) $\textrm{T} \rightarrow \infty$ の場合
</h2>


<p>
だいぶ長くなりましたが、最後に 何故「$\textrm{T} \rightarrow \infty$ にすると非周期的な $f_{pd}(t)$ が周期的な $f(t)$ に変わる」かについて説明します。
<br>
なお有限の範囲では $\textrm{T}$ をいくら大きくしたところで周期的な $f_{pd}(t)$ が非周期的になる訳では無いことには注意してください。
</p>

<p>
<b>1. 複素フーリエ級数展開を使った説明</b>
</p>

<p>
まず一般的なテキストでよく引用されている説明から示します。
<br>
$f_{pd}(t)$ の複素フーリエ級数展開は
</p>

\begin{align*}
f_{pd}(t)
&= \sum_{k = -\infty}^{\infty} 
\left \{
\textrm{C}[k] \cdot \textrm{e}^{\{j \cdot k \cdot w_1 \cdot t \}}
\right \} \\[10pt]

&= 
\sum_{k=-\infty}^{\infty}
\left \{
\frac{1}{\textrm{T}}
\cdot 
\textrm{F}(k\cdot w_1) \cdot \textrm{e}^{\{j \cdot k \cdot w_1 \cdot t \}} 
\right \}
\\[10pt]

&= 
\frac{1}{2\pi} \cdot 
\sum_{k=-\infty}^{\infty}
\left \{
w_1 \cdot 
\textrm{F}(k\cdot w_1) \cdot \textrm{e}^{\{j \cdot k \cdot w_1 \cdot t \}} 
\right \}
\\[10pt]

\end{align*}

<p>
と変形できますが、$w_1 = 2\pi/\textrm{T}$ はサンプリング間隔で $\textrm{T} \rightarrow \infty$ の時 $w_1 \rightarrow 0$ になりますので、最後の級数は<a href="https://ja.wikipedia.org/wiki/%E3%83%AA%E3%83%BC%E3%83%9E%E3%83%B3%E5%92%8C">リーマン和</a>となります。
<br>
よって $\textrm{T} \rightarrow \infty$ の時に総和は<a href="https://ja.wikipedia.org/wiki/%E3%83%AA%E3%83%BC%E3%83%9E%E3%83%B3%E7%A9%8D%E5%88%86">リーマン積分</a>(普通の積分)に置き換えれますので
</p>

\begin{align*}
\lim_{\textrm{T} \rightarrow \infty} 
f_{pd}(t)

&= 
\lim_{\textrm{T} \rightarrow \infty} 
\frac{1}{2\pi} \cdot 
\sum_{k=-\infty}^{\infty}
\left \{
w_1 \cdot 
\textrm{F}(k\cdot w_1) \cdot \textrm{e}^{\{j \cdot k \cdot w_1 \cdot t \}} 
\right \}
\\[10pt]

&= 
\frac{1}{2\pi} \cdot 
\int_{-\infty}^{\infty}
\left \{
\textrm{F}(w) \cdot \textrm{e}^{\{j \cdot w \cdot t \}} 
\right \}
\\[10pt]

(\text{逆フーリエ変換の定義なので})
&= 
f(t)

\end{align*}


<p>
となります。
</p>


<br>
<p>
<b>2. フーリエ変換の極限を使った説明</b>
</p>

<p>
矩形の窓関数 $\textrm{rect}(t)$ のフーリエ変換は $\textrm{T} \rightarrow \infty$ の時次のようになります。
</p>


\begin{align*}
\lim_{\textrm{T} \rightarrow \infty} 
\textrm{T} \cdot \textrm{sinc} \frac{ w \cdot \textrm{T} }{2}
&= 
\lim_{\textrm{T} \rightarrow \infty} 
\textrm{T} \cdot \textrm{sinc} \left ( \pi \cdot \frac{w}{2\pi} \cdot T \right ) \\[10pt]
&= 
\delta \left ( \frac{w}{2\pi} \right ) \\[10pt]
&= 
2\pi \cdot \delta (w)
\end{align*}

<p>
よって(10)より
</p>

\begin{align*}
\lim_{\textrm{T} \rightarrow \infty} 
\textrm{F}(w) 

&= 
\lim_{\textrm{T} \rightarrow \infty} 
\textrm{T} \cdot 
\sum_{k=-\infty}^{\infty}
\textrm{C}[k] \cdot 
\textrm{sinc} \frac{ (w - k \cdot w_1) \cdot \textrm{T} }{2} \\[10pt]

&= 
\sum_{k=-\infty}^{\infty}
\lim_{\textrm{T} \rightarrow \infty} \textrm{C}[k] \cdot 
\lim_{\textrm{T} \rightarrow \infty} 
\textrm{T} \cdot 
\textrm{sinc} \frac{ (w - k \cdot w_1) \cdot \textrm{T} }{2} \\[10pt]


&=
\sum_{k=-\infty}^{\infty}
\lim_{\textrm{T} \rightarrow \infty} 
2\pi \cdot \textrm{C}[k] \cdot  \delta (w - k \cdot w_1) \\[10pt]

(\textrm{(5)より})
&=
\lim_{\textrm{T} \rightarrow \infty} 
w_1 \cdot 
\textrm{F}_{imp}(w) \\[10pt]
\end{align*}

<p>
つまり $\textrm{T} \rightarrow \infty$ の場合 $f(t)$ と $f_{pd}(t)$ のフーリエ変換が一致するので $f(t)$ は $f_{pd}(t)$ に一致します。
</p>

<br>
<script>PreNext(2,4)</script>
</body>
</html>
