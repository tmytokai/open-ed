<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link rel="stylesheet" href="../../../common.css" type="text/css" />
<title>ジャンプさせる</title>
</head>
<body>
<b>Scratch is developed by the Lifelong Kindergarten Group at the MIT Media Lab. See <a href="http://scratch.mit.edu">http://scratch.mit.edu</a></b>
<br>

<h2>ジャンプさせる</h2>

最後に Cat をジャンプさせてみましょう。
<br>
<br>
まずキーボードのジャンプキー(今回はxキー)を押しているかどうかの判定はジャンプの時と同様に「Input」クラスの「GetAxis」というメソッドをパラメータに"Fire1"を指定して使います。すると z キーを押していると true、話していると false という値が取得できます。
<br>
<br>
また、Unity2Dのゲームオブジェクトをジャンプさせるためには「Rigidbody2D」コンポーネントをアタッチしてから「AddForce」メソッドを使います。
<br>
<br>
この Rigidbody2D コンポーネントの AddForce メソッドはゲームオブジェクトに外部から力を加えるためのメソッドで、力を加える方向と強さを2次元ベクトルで指定します。
<br>
<br>
例えば Cat の「Update」イベントの中に図1の様なスクリプトを作成して x を押すと Cat は上にジャンプします。
<br>
<br>
(注) 実際の Unity では AddForce はメソッドなので、AddForce.y のようなプロパティはありません。
<br>
また、「そうでなければ AddForce を 0 にする」の部分も必要ありません。
<br>
これらは単にscratch2unityの仕様上の問題ですので、Unityの実際のスクリプトではどう書くのかについては自分で調べてみて下さい。
<br>
<br>
<pre class="prog">
<input type="checkbox">図1: ジャンプスクリプト(駄目な例)
<br>
<img src="./fig/jump1.png">
</pre>
<br>
ところがこのスクリプトには Cat が空中にいる時でも x キーを押すとジャンプしてしまうというバグがありますので、 Cat が空中にいるのか地上にいるのか判定してジャンプする必要があります。
<br>
<br>
さてゲームオブジェクトが空中にいるのか地上にいるのか判定する方法はいくつかありますが、「Physics2D」クラスの「Linecast」メソッドを使う方法が良く使われているようです。
<br>
<br>
この「Physics2D」クラスの「Linecast」メソッドはあるゲームオブジェクトから目に見えない透明な杖を指定した方向に延ばして、その杖が他のオブジェクトに触れているかを調べるために使います(図2、図3)。
<br>
触れていれば true 、触れていなければ false の値が取得できます。
<br>
<br>
<pre class="prog">
<input type="checkbox">図2: 透明な杖が地面と触れてないので空中にいる
<br>
<img src="./fig/linecast.png">
</pre>
<br>
<br>
<pre class="prog">
<input type="checkbox">図3: 透明な杖が地面と触れているので地上にいる
<br>
<img src="./fig/linecast2.png">
</pre>

<br>
今回の scratch2unity では、「もし〜なら」の条件として図4のスクリプトを使うと他のスクリプトに触れているかどうかを判定できます。
<br>
<br>
(注) 実際の Unity では上下左右に杖を伸ばせますが、今回は簡略化して下方向だけのチェックにしています。
<br>
Unityの実際のスクリプトではどう書くのかについては自分で調べてみて下さい。
<br>
<pre class="prog">
<input type="checkbox">図4: Linecast で自分の下にオブジェクトがあるかどうか判定
<br>
<img src="./fig/linecast3.png">
</pre>

<br>
<br>
<br>

</body>
</html>
