<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<link rel="stylesheet" href="../../../common.css">
<title>変数とメモリ空間</title>
</head>
<body>

<p>
<a href="../">アクティビティ: C言語のポインター</a>
<br>
学習項目: [2] 実際のメモリ空間
</p>

<h2>変数とメモリ空間</h2>

<p>
ここでは C 言語の変数が実際にどのようにメモリ空間に配置されているのか、sizeof 演算子やアドレス演算子を通じて学びます。
</p>

<br>
<h3>
1. sizeof 演算子で変数の使用データサイズを調べる
</h3>

<p>
C 言語の変数の事を「何だか良く分からないけど、数字を入れる箱みたいな物」と漠然と覚えている人も多いのですが、正しくは「メモリ空間内にある 1 〜 多バイトからなるデータ領域」のことを変数と言います。
</p>

<p>
さて、 C 言語の変数には char 型、int 型 など様々なデータ型がありますが、それらの変数が実際のところメモリ空間内で何バイト分のデータになっているか調べるためには「sizeof演算子」を使います。
</p>

<p>
この sizeof 演算子の使い方には
</p>

<pre class="prog">
(1) sizeof(型の名前)
(2) sizeof(変数の名前)
</pre>

<p>
と 2 通りの方法があり、前者は、例えば
</p>

<pre class="prog">
sizeof(char)
</pre>

<p>
の様に書くと char 型の変数がメモリ空間内で使うデータサイズ( byte )が得られます。また後者は
</p>

<pre class="prog">
(char a を定義してから) sizeof(a)
</pre>

<p>
の様に書くと char 型の変数 a ひとつがメモリ空間内で使用するデータサイズ( byte )が得られます。
</p>

<p>
なお、ある型が何バイト分のデータになるのかは大体は規格で決まっているのですが、環境(CPUとかOSとかの違い)によって微妙に異なる場合があるのでプログラマは注意する必要があります(※)。
</p>

<p>
※ 例えば int 型とか long 型とかは OS が 32 bit か 64 bit かによって 32 bit だったり 64 bit だったりするので 20 世紀終わりから 21 世紀初頭にかけて大問題になっていました。
</p>

<br>
<h3>
2. アドレス演算子で変数が置いてある場所(アドレス)を調べる
</h3>

<p>
ある変数の大きさ(データサイズ)は sizeof 演算子で得られますので、次はその変数がメモリ空間内のどの場所に配置されているのか「アドレス演算子」を使って調べてみましょう。
</p>

<pre class="prog">
&amp;変数名
</pre>

<p>
のように変数の前に付けた「&amp;」の事をアドレス演算子と呼んで、その変数のアドレスを得るために使えます。
<br>
例えば
</p>


<pre class="prog">
(char a を定義してから) &amp;a
</pre>

<p>
の様に書くと char 型の変数 a のアドレスが得られます。
</p>

<p>
なおアドレスの桁数はメモリ空間の広さ、つまりメモリの最大サイズを表していて、例えばアドレスの桁数が(16進数で) 2 桁 ならばアドレスの範囲は「0x00 番地 〜 0xFF 番地」となるので最大メモリサイズは 255 byte となります。
</p>

<p>
実際のアドレスの桁数は環境(CPUとかOSとかの違い)によって変わりますが、一般的に 64 bit OS なら桁数は 16 桁、最大メモリサイズは「0x0000000000000000 番地 〜 0xFFFFFFFFFFFFFFFF番地」の 16777216 TiB = 18,446,744,073,709,551,616 byteとなります(※)。
</p>

<p>
※ あくまで理論サイズで、あるコンピュータに実際に載せられる物理的なメモリサイズは色々な制約からずっと少ないです。もし興味があれば「仮想メモリ」についてもネットで調べてみると良いでしょう。
</p>



</body>
</html>
